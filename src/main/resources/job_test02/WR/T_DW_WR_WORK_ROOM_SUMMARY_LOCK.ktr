<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>T_DW_WR_WORK_ROOM_SUMMARY_LOCK</name>
    <description />
    <extended_description />
    <trans_version />
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection />
        <schema />
        <table />
        <size_limit_lines />
        <interval />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject />
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject />
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject />
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject />
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject />
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject />
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection />
        <schema />
        <table />
        <interval />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection />
      <table />
      <field />
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file />
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2020/06/28 11:26:56.502</created_date>
    <modified_user>-</modified_user>
    <modified_date>2020/06/28 11:26:56.502</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>oracle</name>
    <server>10.12.81.8</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>report</database>
    <port>1521</port>
    <username>fsscreport</username>
    <password>LsY6kPWYuJZf1SsY</password>
    <servername />
    <data_tablespace />
    <index_tablespace />
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1521</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>工抵房总表-季度锁板</from>
      <to>插入 / 更新</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>工抵房总表-季度锁板</name>
    <type>TableInput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>oracle</connection>
    <sql>with data1 as(-- 按账单维度对 工抵房统计表下【全集团】房间的 已回款金额 汇总
select to_char(qsdate,'yyyy') years  --年份
      ,substr(buname, 1, instr(buname, '龙湖',  -1) - 1) area  --地区 
      ,buname                                       --公司
      ,projname                                     --分期名
      ,parentprojname                               --项目名
      ,bldname                                      --楼栋名
      ,ztname                                       --组团名
      ,x_yfproducttypecode                          --业态code
      ,x_yfproducttypename                          --业态名陈
      ,roomcode                                     --房间名
      ,cstallname                                   --客户名称
      ,rgdate                                       --认购日期
      ,qsdate                                       --签约日期
      ,netcontractdate                              --网签日期
      ,ishavezfwq                                   --是否政府网签
      ,itemtype                                     --款项类型
      ,payformname                                  --付款方式名称
      ,payformtype                                  --付款方式类型
      ,roomtotal                                    --标准总价
      ,bldarea                                      --建筑面积
      ,tnarea                                       --套内面积
      ,cjrmbtotal                                   --成交总价
      ,cjbldprice                                   --建筑成交单价
      ,cjtnprice                                    --套内成交单价
      ,sum(nvl(amount,0)) amount                    --已回款金额
      ,zydate                                       --滞纳天数
      ,nvl(rmbye,0) rmbye                           --欠款
      ,case when zydate>=0 then nvl(rmbye,0)  end wdq_rmbye --未到期欠款
      ,case when zydate&lt;0 then nvl(rmbye,0)   end yyq_rmbye --已逾期欠款
      ,jbdate                                       --竣备日期
      ,jfdate                                       --合同交房日期
      ,yyjfdate                                     --运营交房时间
      ,znj                                          --滞纳金
      ,feeguid                                      --账单id
      ,hdzj                                         --核定总价
      ,due_date                                     --应付款日期
      --,payment_date                                 --回款日期
  from ods_wr_work_room_detail t
  where 1=1 --to_char(qsdate,'yyyy')=to_char(sysdate-1,'yyyy')
  and qsdate &lt; =to_date(to_char(sysdate-1,'yyyy-mm-dd'),'yyyy-mm-dd')
  group by buname
      ,projname
      ,parentprojname
      ,bldname
      ,ztname
      ,x_yfproducttypecode
      ,x_yfproducttypename
      ,roomcode
      ,cstallname
      ,rgdate
      ,qsdate
      ,netcontractdate
      ,ishavezfwq
      ,itemtype
      ,payformname
      ,payformtype
      ,roomtotal
      ,bldarea
      ,tnarea
      ,cjrmbtotal
      ,cjbldprice
      ,cjtnprice
      ,zydate
      ,rmbye
      ,jbdate
      ,jfdate
      ,yyjfdate
      ,znj
      ,feeguid
      ,hdzj                                       
      ,due_date                                    
      --,payment_date  
 )
,data2 as(-- 按房间维度汇总
select years          --年份
      ,area           --地区
      ,parentprojname --项目
      ,projname       --分期
      ,roomcode       --房间
      ,qsdate         --签约时间
      ,cjrmbtotal     --成交总价
      ,hdzj           --核定总价
      ,amount         --已回款金额
      ,sum(nvl(wdq_rmbye,0))   wdq_rmbye   --未到期欠款
      ,sum(nvl(yyq_rmbye,0))   yyq_rmbye   --已逾期欠款
  from data1 
  group by years          --年份
          ,area           --地区
          ,parentprojname --项目
          ,projname       --分期
          ,roomcode       --房间
          ,qsdate         --签约时间
          ,cjrmbtotal     --成交总价
          ,hdzj           --核定总价
          ,amount         --已回款金额
  )
,base3 as(
--工抵总量  
--房间数量：工抵房统计表下【全集团】房间 的总数量
--合同金额：工抵房统计表下【全集团】房间 的【合同金额-成交总价】总额
select years --年份
      ,area --地区
      ,parentprojname --项目
      ,projname --分期
      ,count(roomcode) gdzl_count --工抵总量-房间数量
      ,sum(hdzj) gdzl_account --工抵总量-合同金额
      ,0 ykq_count --已款齐-房间数量
      ,0 ykq_account --已款齐-合同金额
      ,0 kwq_count --款未齐-房间数量
      ,0 kwq_account --款未齐-合同金额
      ,0 wdq --款未齐欠款金额-未到期
      ,0 bydq --款未齐欠款金额-本月到期
      ,0 yq --款未齐欠款金额-已逾期
  from data2
 group by years --年份
         ,area --地区
         ,parentprojname --项目
         ,projname --分期
union all
--已款齐  
--房间数量：工抵房统计表下【全集团】的房间数量，且满足【已付款金额】-【合同金额】=0（或【欠款总额】=0）
--合同金额：工抵房统计表下【全集团】的房间合同总额，且满足【已付款金额】-【合同金额】=0（或【欠款总额】=0）
select years --年份
      ,area --地区
      ,parentprojname --项目
      ,projname --分期
      ,0 gdzl_count --工抵总量-房间数量
      ,0 gdzl_account --工抵总量-合同金额
      ,count(roomcode) ykq_count --已款齐-房间数量
      ,sum(hdzj) ykq_account --已款齐-合同金额
      ,0 kwq_count --款未齐-房间数量
      ,0 kwq_account --款未齐-合同金额
      ,0 wdq --款未齐欠款金额-未到期
      ,0 bydq --款未齐欠款金额-本月到期
      ,0 yq --款未齐欠款金额-已逾期
  from data2
  where cjrmbtotal=amount   --【已付款金额】-【合同金额】=0（或【欠款总额】=0
 group by years --年份
         ,area --地区
         ,parentprojname --项目
         ,projname --分期
         
union all
--款未齐  
--房间数量：工抵房统计表下【全集团】的房间数量，且满足【已付款金额】-【合同金额】≠0（或【欠款总额】≠0）
--合同金额：工抵房统计表下【全集团】的房间合同总额，且满足【已付款金额】-【合同金额】≠0（或【欠款总额】≠0）
select years --年份
      ,area --地区
      ,parentprojname --项目
      ,projname --分期
      ,0 gdzl_count --工抵总量-房间数量
      ,0 gdzl_account --工抵总量-合同金额
      ,0 ykq_count --已款齐-房间数量
      ,0 ykq_account --已款齐-合同金额
      ,count(roomcode) kwq_count --款未齐-房间数量
      ,sum(hdzj) kwq_account --款未齐-合同金额
      ,0 wdq --款未齐欠款金额-未到期
      ,0 bydq --款未齐欠款金额-本月到期
      ,0 yq --款未齐欠款金额-已逾期
  from data2
  where cjrmbtotal&lt;&gt;amount   --【已付款金额】-【合同金额】≠0（或【欠款总额】≠0）
 group by years --年份
         ,area --地区
         ,parentprojname --项目
         ,projname --分期

union all
--款未齐欠款金额  未到期：工抵房统计表下【全集团】、【未到期未到账金额】≠0的房间合同总额
select years --年份
      ,area --地区
      ,parentprojname --项目
      ,projname --分期
      ,0 gdzl_count --工抵总量-房间数量
      ,0 gdzl_account --工抵总量-合同金额
      ,0 ykq_count --已款齐-房间数量
      ,0 ykq_account --已款齐-合同金额
      ,0 kwq_count --款未齐-房间数量
      ,0 kwq_account --款未齐-合同金额
      ,sum(wdq_rmbye) wdq --款未齐欠款金额-未到期
      ,0 bydq --款未齐欠款金额-本月到期
      ,0 yq --款未齐欠款金额-已逾期
  from data2
  where wdq_rmbye&lt;&gt;0
 group by years --年份
         ,area --地区
         ,parentprojname --项目
         ,projname --分期
         
union all
--款未齐欠款金额-已逾期：工抵房统计表下【全集团】、【已到期总额】≠0的房间合同总额
select years --年份
      ,area --地区
      ,parentprojname --项目
      ,projname --分期
      ,0 gdzl_count --工抵总量-房间数量
      ,0 gdzl_account --工抵总量-合同金额
      ,0 ykq_count --已款齐-房间数量
      ,0 ykq_account --已款齐-合同金额
      ,0 kwq_count --款未齐-房间数量
      ,0 kwq_account --款未齐-合同金额
      ,0 wdq --款未齐欠款金额-未到期
      ,0 bydq --款未齐欠款金额-本月到期
      ,sum(yyq_rmbye) yq --款未齐欠款金额-已逾期
  from data2
  where yyq_rmbye&lt;&gt;0
 group by years --年份
         ,area --地区
         ,parentprojname --项目
         ,projname --分期       

union all
--款未齐欠款金额-本月到期：30天内到期
select years --年份
      ,area --地区
      ,parentprojname --项目
      ,projname --分期
      ,0 gdzl_count --工抵总量-房间数量
      ,0 gdzl_account --工抵总量-合同金额
      ,0 ykq_count --已款齐-房间数量
      ,0 ykq_account --已款齐-合同金额
      ,0 kwq_count --款未齐-房间数量
      ,0 kwq_account --款未齐-合同金额
      ,0 wdq --款未齐欠款金额-未到期
      ,sum(rmbye) bydq --款未齐欠款金额-本月到期
      ,0 yq --款未齐欠款金额-已逾期
  from data1
  where --zydate between 0 and 30
  due_date between sysdate-1 and add_months(sysdate-1,1)
 group by years --年份
         ,area --地区
         ,parentprojname --项目
         ,projname --分期       
    
 
 )

select to_date(to_char(sysdate-1,'yyyy-mm-dd'),'yyyy-mm-dd') datekey
      ,years --年份
      ,nvl(b.area,base3.area) area --地区
      ,parentprojname --项目
      ,projname --分期
      ,sum(gdzl_count) gdzl_count --工抵总量-房间数量
      ,sum(gdzl_account) gdzl_account --工抵总量-合同金额 
      ,sum(ykq_count) ykq_count --已款齐-房间数量
      ,sum(ykq_account) ykq_account --已款齐-合同金额
      ,sum(kwq_count) kwq_count --款未齐-房间数量
      ,sum(kwq_account) kwq_account --款未齐-合同金额
      ,sum(wdq) wdq --款未齐欠款金额-未到期
      ,sum(bydq) bydq --款未齐欠款金额-本月到期
      ,sum(yq) yq --款未齐欠款金额-已逾期
      ,sum(wdq)+sum(yq) kwq_total      --款未齐欠款金额-小计
 from base3  
 left join dw_wr_area_company b
      on base3.area = b.company   
 group by years --年份
         ,nvl(b.area,base3.area) --地区
         ,parentprojname --项目
         ,projname --分期       
  
</sql>
    <limit>0</limit>
    <lookup />
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>288</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>插入 / 更新</name>
    <type>InsertUpdate</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>oracle</connection>
    <commit>1000</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema />
      <table>DW_WR_WORK_ROOM_SUMMARY_LOCK</table>
      <key>
        <name>DATEKEY</name>
        <field>DATEKEY</field>
        <condition>=</condition>
        <name2 />
      </key>
      <key>
        <name>YEARS</name>
        <field>YEARS</field>
        <condition>=</condition>
        <name2 />
      </key>
      <key>
        <name>PARENTPROJNAME</name>
        <field>PARENTPROJNAME</field>
        <condition>=</condition>
        <name2 />
      </key>
      <key>
        <name>PROJNAME</name>
        <field>PROJNAME</field>
        <condition>=</condition>
        <name2 />
      </key>
      <value>
        <name>DATEKEY</name>
        <rename>DATEKEY</rename>
        <update>N</update>
      </value>
      <value>
        <name>YEARS</name>
        <rename>YEARS</rename>
        <update>Y</update>
      </value>
      <value>
        <name>AREA</name>
        <rename>AREA</rename>
        <update>Y</update>
      </value>
      <value>
        <name>PARENTPROJNAME</name>
        <rename>PARENTPROJNAME</rename>
        <update>Y</update>
      </value>
      <value>
        <name>PROJNAME</name>
        <rename>PROJNAME</rename>
        <update>Y</update>
      </value>
      <value>
        <name>GDZL_COUNT</name>
        <rename>GDZL_COUNT</rename>
        <update>Y</update>
      </value>
      <value>
        <name>GDZL_ACCOUNT</name>
        <rename>GDZL_ACCOUNT</rename>
        <update>Y</update>
      </value>
      <value>
        <name>YKQ_COUNT</name>
        <rename>YKQ_COUNT</rename>
        <update>Y</update>
      </value>
      <value>
        <name>YKQ_ACCOUNT</name>
        <rename>YKQ_ACCOUNT</rename>
        <update>Y</update>
      </value>
      <value>
        <name>KWQ_COUNT</name>
        <rename>KWQ_COUNT</rename>
        <update>Y</update>
      </value>
      <value>
        <name>KWQ_ACCOUNT</name>
        <rename>KWQ_ACCOUNT</rename>
        <update>Y</update>
      </value>
      <value>
        <name>WDQ</name>
        <rename>WDQ</rename>
        <update>Y</update>
      </value>
      <value>
        <name>BYDQ</name>
        <rename>BYDQ</rename>
        <update>Y</update>
      </value>
      <value>
        <name>YQ</name>
        <rename>YQ</rename>
        <update>Y</update>
      </value>
      <value>
        <name>KWQ_TOTAL</name>
        <rename>KWQ_TOTAL</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>528</xloc>
      <yloc>144</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>
